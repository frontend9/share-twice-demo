"use strict";const shareDom=document.getElementsByTagName("meta").shareAuto,shareAuto=!!shareDom&&"true"===shareDom.getAttribute("content"),shareTwice={config(e){const n={},i=document.getElementsByTagName("meta").shareTitle||document.getElementsByTagName("title")[0],t=document.getElementsByTagName("meta").shareDesc,s=document.getElementsByTagName("meta").shareLink,o=document.getElementsByTagName("meta").shareImage;n.title=i.getAttribute("content")||i.innerText,n.desc=t?t.getAttribute("content"):"",n.link=s?s.getAttribute("content"):document.location.href,n.image=o?o.getAttribute("content"):"https://gw.alipayobjects.com/zos/rmsportal/PbxcajsXkcfiWIYdRxaw.jpg",n.successFun=function(){},n.failFun=function(e){},this.shareConfig=Object.assign(n,e||{}),this.isDing(),this.isWechat()},isWechat(){if(~window.navigator.userAgent.indexOf("MicroMessenger")){const e=this;void 0===window.wx?e._loadScript("//res.wx.qq.com/open/js/jweixin-1.2.0.js",function(){e._shareInWechat()}):e._shareInWechat()}},isDing(){const e=this;~window.navigator.userAgent.indexOf("DingTalk")&&(void 0===window.dd?e._loadScript("//g.alicdn.com/ilw/ding/0.9.9/scripts/dingtalk.js",function(){e._shareInDing()}):e._shareInDing())},_shareInDing(){const e=this;dd.ready(function(){dd.biz.navigation.setRight({show:!0,control:!0,text:"",onSuccess:function(n){dd.biz.util.share({type:0,url:e.shareConfig.link,title:e.shareConfig.title,content:e.shareConfig.desc,image:e.shareConfig.image,onSuccess:e.shareConfig.successFun,onFail:e.shareConfig.failFun})},onFail:function(e){}})})},_shareInWechat(){const e=this;e._getConfigs(function(n){n.link=n.url,delete n.url,e.shareConfig=Object.assign(e.shareConfig,n),wx.config({debug:e.shareConfig.debug,appId:e.shareConfig.appId,timestamp:e.shareConfig.timestamp,nonceStr:e.shareConfig.nonceStr,signature:e.shareConfig.signature,jsApiList:["openEnterpriseChat","openEnterpriseContact","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","onMenuShareQZone","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice","getNetworkType","openLocation","getLocation","hideOptionMenu","showOptionMenu","hideMenuItems","showMenuItems","hideAllNonBaseMenuItem","showAllNonBaseMenuItem","closeWindow","scanQRCode"]}),wx.ready(()=>{wx.onMenuShareTimeline({title:e.shareConfig.title,desc:e.shareConfig.desc,link:e.shareConfig.link,imgUrl:e.shareConfig.image,success:e.shareConfig.successFun,cancel:e.shareConfig.failFun}),wx.onMenuShareAppMessage({title:e.shareConfig.title,desc:e.shareConfig.desc,link:e.shareConfig.link,imgUrl:e.shareConfig.image,success:e.shareConfig.successFun,cancel:e.shareConfig.failFun}),wx.onMenuShareQQ({title:e.shareConfig.title,desc:e.shareConfig.desc,link:e.shareConfig.link,imgUrl:e.shareConfig.image,success:e.shareConfig.successFun,cancel:e.shareConfig.failFun}),wx.onMenuShareWeibo({title:e.shareConfig.title,desc:e.shareConfig.desc,link:e.shareConfig.link,imgUrl:e.shareConfig.image,success:e.shareConfig.successFun,cancel:e.shareConfig.failFun}),wx.onMenuShareQZone({title:e.shareConfig.title,desc:e.shareConfig.desc,link:e.shareConfig.link,imgUrl:e.shareConfig.image,success:e.shareConfig.successFun,cancel:e.shareConfig.failFun})})})},_getConfigs(e){$.ajax({method:"POST",url:"some.php",data:{url:document.location.href.split("#")[0]}}).done(function(n){e()})},_loadScript(e,n){let i=document.createElement("script");i.setAttribute("async","async"),i.setAttribute("src",e),i.setAttribute("charset","utf-8"),i.onload=(()=>{n()}),document.getElementsByTagName("head")[0].appendChild(i)}};"undefined"!=typeof define&&define.amd?define([],function(){return shareAuto&&shareTwice.config({}),shareTwice}):"undefined"!=typeof module&&module.exports?(module.exports=shareTwice,shareAuto&&shareTwice.config({})):shareAuto&&shareTwice.config({});
